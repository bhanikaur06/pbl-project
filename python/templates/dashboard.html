<!DOCTYPE html>
<html>
<head>
  <title>Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
      body {
          background-color: #f8f9fc;
      }
      .card {
          border-radius: 15px;
      }
      footer {
          background: #343a40;
          color: white;
          padding: 15px;
          margin-top: 40px;
      }
  </style>
</head>
<body>

<nav class="navbar navbar-dark bg-primary shadow">
  <div class="container">
    <span class="navbar-brand fw-bold">üö® Path Pulse Dashboard</span>
    <a href="/" class="btn btn-light">Home</a>
  </div>
</nav>

<div class="container mt-4">

<div class="row">
    <div class="col-md-6">
        <div class="card shadow p-3 mb-4">
            <h5 class="fw-bold">üìç Current Location</h5>
            <p id="coords">Fetching location...</p>
            <div id="map" style="height:250px;"></div>
        </div>
    </div>

    <div class="col-md-6">
        <div class="card shadow p-3 mb-4 text-center">
            <h5 class="fw-bold">üö¶ Status</h5>
            <span id="status" class="badge bg-success fs-5">SAFE</span>
            <div id="alertBox" class="alert alert-danger mt-3 d-none">
                SOS ALERT! Unusual movement detected.
            </div>
            <a href="/history" class="btn btn-outline-primary mt-3">
                View History
            </a>
        </div>
    </div>
</div>

</div>

<footer class="text-center">
    Path Pulse Safety System | 2026
</footer>

<script>
navigator.geolocation.getCurrentPosition(function(pos) {
    let lat = pos.coords.latitude;
    let lon = pos.coords.longitude;

    document.getElementById("coords").innerText =
        "Latitude: " + lat + " | Longitude: " + lon;

    document.getElementById("map").innerHTML =
        `<iframe width="100%" height="250"
        src="https://maps.google.com/maps?q=${lat},${lon}&z=15&output=embed">
        </iframe>`;

    fetch("/update_location", {
        method: "POST",
        headers: {"Content-Type": "application/x-www-form-urlencoded"},
        body: `lat=${lat}&lon=${lon}`
    })
    .then(res => res.json())
    .then(data => {
        if (data.status === "SAFE") {
            document.getElementById("status").innerText = "SAFE";
            document.getElementById("status").className = "badge bg-success fs-5";
            document.getElementById("alertBox").classList.add("d-none");
        } else {
            document.getElementById("status").innerText = "SOS ALERT";
            document.getElementById("status").className = "badge bg-danger fs-5";
            document.getElementById("alertBox").classList.remove("d-none");
        }
    });
});
</script>

</body>
</html>






